<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>비밀번호 변경</title>
  <link rel="stylesheet" th:href="@{/css/changePassword.css}">
</head>
<body>
<div class="container">
  <h2>비밀번호 변경</h2>

  <div th:if="${error}" class="error-message">
    <p th:text="${error}"></p>
  </div>

  <form th:action="@{/member/changePassword_pro}" method="post" onsubmit="return validatePasswordChange();">
    <div class="form-group">
      <label for="currentPassword">현재 비밀번호</label>
      <input type="password" id="currentPassword" name="currentPassword" class="input-field" required>
      <span id="currentPasswordError" class="error-message" style="display: none;">현재 비밀번호를 입력하세요.</span>
    </div>

    <div class="form-group">
      <label for="newPassword">새 비밀번호</label>
      <input type="password" id="newPassword" name="newPassword" class="input-field" required>
      <span id="newPasswordError" class="error-message" style="display: none;">비밀번호는 8~16자리로 입력해야 합니다.</span>
    </div>

    <div class="form-group">
      <label for="confirmPassword">새 비밀번호 확인</label>
      <input type="password" id="confirmPassword" name="confirmPassword" class="input-field" required>
      <span id="confirmPasswordError" class="error-message" style="display: none;">비밀번호가 일치하지 않습니다.</span>
    </div>

    <button type="submit" class="button">비밀번호 변경</button>
    <a th:href="@{/member/memberinfo}" class="button cancel">취소</a>
  </form>

</div>
<script>
  function validatePasswordChange() {
    let currentPassword = document.getElementById("currentPassword").value.trim();
    let newPassword = document.getElementById("newPassword").value.trim();
    let confirmPassword = document.getElementById("confirmPassword").value.trim();

    let isValid = true;

    // 현재 비밀번호 입력 여부 확인
    if (currentPassword === "") {
      document.getElementById("currentPasswordError").style.display = "block";
      isValid = false;
    } else {
      document.getElementById("currentPasswordError").style.display = "none";
    }

    // 비밀번호 길이 검사
    if (newPassword.length < 8 || newPassword.length > 16) {
      document.getElementById("newPasswordError").style.display = "block";
      isValid = false;
    } else {
      document.getElementById("newPasswordError").style.display = "none";
    }

    // 비밀번호 일치 여부 검사
    if (newPassword !== confirmPassword) {
      document.getElementById("confirmPasswordError").style.display = "block";
      isValid = false;
    } else {
      document.getElementById("confirmPasswordError").style.display = "none";
    }

    return isValid; // 유효성 검사를 통과해야 폼이 제출됨
  }
</script>
</body>
</html>
